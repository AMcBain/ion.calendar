// Ion.Calendar
// version 1.1.59
// http://ionden.com/a/plugins/ion.calendar/
var moment=moment||{};(function(j){j.fn.ionCalendar=function(d){var e=this,g=j.extend({lang:e.data("lang")||"ru",format:e.data("format")||"D.M.YYYY",start:e.data("start")||"none",onUpdate:null,onClick:null},d);moment.lang(g.lang);var c='<div class="ion_calendar_head">',c=c+'<div class="ion_calendar_top_date"><input class="ion_set_year" type="text" value="loading..." /></div>',c=c+'<div class="ion_arr ion_arr_prev">&lt;</div>',c=c+'<div class="ion_arr ion_arr_next">&gt;</div>',c=c+"</div>",c=c+'<div class="ion_week"></div>',c=
c+'<div class="ion_month"></div>';d=moment();var b='<table class="ion_table_week"><tr>',b=b+("<td>"+d.day(1).format("dd")+"</td>"),b=b+("<td>"+d.day(2).format("dd")+"</td>"),b=b+("<td>"+d.day(3).format("dd")+"</td>"),b=b+("<td>"+d.day(4).format("dd")+"</td>"),b=b+("<td>"+d.day(5).format("dd")+"</td>"),b=b+("<td>"+d.day(6).format("dd")+"</td>"),b=b+("<td>"+d.day(0).format("dd")+"</td>"),b=b+"</tr></table>";({init:function(){var a=this;e.addClass("ion_calendar");e.html(c);this.field_year=e.find(".ion_calendar_top_date");
this.input_year=e.find(".ion_set_year");this.btn_prev=e.find(".ion_arr_prev");this.btn_next=e.find(".ion_arr_next");this.week_content=e.find(".ion_week");this.days_content=e.find(".ion_month");this.startDate=moment(g.start,"D.M.YYYY");this.baseDate=this.startDate.isValid()?moment(this.startDate):moment();this.currentDate=moment(this.baseDate);this.update();this.btn_prev.on("mousedown",function(b){b.preventDefault();a.currentDate.subtract("months",1);a.update()});this.btn_next.on("mousedown",function(b){b.preventDefault();
a.currentDate.add("months",1);a.update()});this.input_year.on("focusin",function(){a.openYear()});this.input_year.on("focusout",function(){a.setYear()});this.input_year.on("keydown",function(b){13===b.which&&(a.setYear(),j(this).blur())})},openYear:function(){this.input_year.val("")},setYear:function(){var a=this.input_year.val()||"none";(a=parseInt(a))&&1900>a?a=1900:a&&2199<a&&(a=2199);moment(a).isValid()?(this.currentDate.year(a),this.update()):this.placeYear()},placeYear:function(){this.input_year.val(this.currentDate.format("MMMM YYYY")+
" \u25bc")},update:function(){this.placeYear();this.week_content.html(b);var a=moment(this.currentDate),c=moment(a.startOf("month")),c=parseInt(c.format("d"));0===c&&(c=7);var f=moment(a.endOf("month")),a=parseInt(f.format("D")),f=parseInt(f.format("d"));0===f&&(f=7);for(var e=c-1+a+(7-f),d='<table class="ion_table_days"><tr>',h=1;h<=e;h++)f=h+1-c,d=0>=f||f>a?d+'<td class="ion_no_day">&nbsp;</td>':this.currentDate.format("YYYY")==this.baseDate.format("YYYY")&&this.currentDate.format("MM")==this.baseDate.format("MM")&&
f==this.baseDate.format("D")?d+('<td class="ion_day ion_current_day">'+f+"</td>"):d+('<td class="ion_day">'+f+"</td>"),h/7==Math.ceil(h/7)&&(d+="</tr><tr>");this.days_content.html(d+"</tr></table>");"function"==typeof g.onUpdate&&g.onUpdate.call(this,this.currentDate.format(g.format));"function"==typeof g.onClick&&this.datePick()},datePick:function(){var a=this;e.addClass("ion_datepicker");this.days_content.find(".ion_day").on("click",function(){var b=parseInt(j(this).text()),c=moment(a.currentDate);
c.date(b);g.onClick.call(a,c.format(g.format))})}}).init()}})(jQuery);